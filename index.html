<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1,
width=device-width, height=device-height, target-densitydpi=device-dpi" />
<head>
    <title>ABCD Bank - Credit Card Validator</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>
<body>
    <div id="header">
        <h1 class="title">ABCD Bank</h1>
        <h1 class="subtitle">ðŸ’³ Credit Card Validator ðŸ’³</h1>
    </div>
    <hr class="divisor">
    <div id="container">
        <form id="validator" onsubmit="return false;">
            <label class="label" for="usuario">Type a quantity (1-100):</label><br>
            <input id="cardsCount" type="text" onkeypress="return show_cards_text(event);" placeholder="Quantity of credit cards numbers"/><br>
            <textarea id="cardsList" placeholder="Type your credit cards numbers here" disabled cols="20" onkeyup="return verify_limit_lines();"></textarea><br>
            <input type="button" value="VALIDATE" disabled />
        </form>
            <hr class="mini-divisor">
            <p class="simple-text">OR</p>   
            <hr class="mini-divisor">
        <form enctype="multipart/form-data" action="save_file.py" method="post">
            <label class="label" for="cards_file">Upload a file (.txt):</label><br>
            <input id="cards_file" name="cards_file" type="file" accept=".txt" onchange="change_file_upload()" /><br><br>
            <input type="submit" id="uploadFile" value="UPLOAD" disabled />
        </form>
    </div>
</body>
</html>
<script type="text/javascript">
function show_cards_text(e) {
    if (e.keyCode == 13) {
        var cardsCount = document.getElementById("cardsCount").value;

        if (cardsCount < 1 || cardsCount > 100) {
            alert("The quantity of credit cards numbers, must be between 1 and 100.");
            return false;
        }

        var cardsList = document.getElementById("cardsList");
        cardsList.style.display = 'block';
        cardsList.disabled = false;
        cardsList.rows = cardsCount;
    }
}

function change_file_upload() {
    var uploadButton = document.getElementById("uploadFile");

    if (document.getElementById("cards_file").value) {
        uploadButton.disabled = false;
        return false;
    }
    uploadButton.disabled = true;
}

function verify_limit_lines() {
    var limit = document.getElementById("cardsCount").value;
    var textarea = document.getElementById("cardsList");
    var spaces = textarea.getAttribute("cols");
    var lines = textarea.value.split("\n");
    
    for (var i = 0; i < lines.length; i++) 
    {
        if (lines[i].length <= spaces) continue;
        var j = 0;
        var space = spaces;
         
        while (j++ <= spaces) 
        {
           if (lines[i].charAt(j) === " ") space = j;  
        }
        lines[i + 1] = lines[i].substring(space + 1) + (lines[i + 1] || "");
        lines[i] = lines[i].substring(0, space);
    }
    if(lines.length>limit)
    {
        textarea.style.color = 'red';
        setTimeout(function(){
            textarea.style.color = '';
        },500);
    }    
    textarea.value = lines.slice(0, limit).join("\n");
}
</script>